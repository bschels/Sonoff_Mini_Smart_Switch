blueprint:
  name: âš¡ Sonoff Universal Smart Switch
  description: |
    ğŸ”Œ **Customize Your Sonoff Smart Switch Setup!**
    
    This blueprint lets you use **Sonoff MiniR4M, MiniR4, ZBMINIR2, and other Sonoff devices** to control different types of devices and configure their behavior.
    
    ğŸ  **Device Selection:** Choose your Sonoff model and what device you want to control, and the blueprint will adapt accordingly.
    
    **Supported Sonoff Devices & Setup Requirements:**
    - ğŸŸ¢ **Sonoff MiniR4M** â†’ Relay detachment enabled by default.
    - ğŸ”µ **Sonoff MiniR4** â†’ Supports relay detachment (enable manually in eWeLink).
    - ğŸŸ  **Sonoff ZBMINIR2** â†’ Zigbee model with local control.
    - ğŸ”´ **Sonoff TX Series** â†’ Wall touch switch with multiple buttons.
    - âšª **Sonoff BasicR3** â†’ Simple Wi-Fi relay switch.
    - âš« **Sonoff S26** â†’ Smart plug with remote control.
    - âš™ï¸ **Other Sonoff Models** â†’ Default settings applied.
    
    **What Can You Control?**
    - ğŸ’¡ **Smart Lamp** (Relay detachment recommended)
    - ğŸ’¡ **Dumb Lamp** (Relay toggles power)
    - ğŸŒ¬ **Bathroom Fan** (Manual & humidity-based automation)
    - ğŸ”¥ **Heater**
    - ğŸ’¨ **Humidifier**
    - âš™ï¸ **Any Smart or Non-Smart Device**
    
    **Bathroom Fan Features:**
    - ğŸ–² **Manual Mode** â†’ Press the switch to run the fan for a set time.
    - ğŸŒ« **Automatic Mode** â†’ The fan turns on when humidity exceeds a threshold.
    - ğŸš¿ **Shower Detection** â†’ Detects rapid humidity increases and starts the fan.
    - ğŸ”„ **Hybrid Mode** â†’ The fan runs manually when pressed and also activates via humidity detection.
    - â³ **Custom Fan Runtime** â†’ Set how long the fan runs after activation.
    - ğŸ“‰ **Auto Off by Humidity** â†’ Optionally turn off the fan when humidity drops.
    
    **Switch Type Behavior:**
    - ğŸš **Rocker Switch** â†’ Stays in either "on" or "off" position. Best for simple toggling.
    - ğŸ”˜ **Push Button** â†’ A momentary switch that supports **single, double, and long press** actions.
    
    **Additional Features:**
    - ğŸ”„ **Relay Detachment (Optional)** â†’ Use the switch independently or toggle the relay.
    - ğŸ­ **Multi-Click Actions** â†’ Customize single, double, and long press actions.
    - ğŸ¬ **Scene Activation** â†’ Trigger Home Assistant scenes.
    - ğŸŒ **Adaptive Lighting** â†’ Adjust brightness & color temperature by time of day.
    - âš¡ **Energy Monitoring** â†’ Get notifications if power usage is too high.
    - ğŸ“Š **Usage Tracking** â†’ Log switch toggles for analysis.
    - ğŸ”” **Notifications** â†’ Alerts when a device turns on/off.
    - ğŸ”„ **Control Multiple Devices** â†’ Toggle multiple devices at once.
    - ğŸ”’ **Safety Lock** â†’ Disable switch input when needed.
    - ğŸŸ¢ **Easy Mode & Advanced Mode** â†’ Quick setup for beginners or full customization for advanced users.
    
  domain: automation
  input:
    easy_mode:
      name: ğŸŸ¢ Easy Mode
      description: "Enable Easy Mode for a simplified setup or Advanced Mode for full customization."
      default: true
      selector:
        boolean:
    device_type:
      name: ğŸ“Œ What Do You Want to Control?
      description: "Choose the type of device you want to control."
      selector:
        select:
          options:
            - "Smart Lamp"
            - "Dumb Lamp"
            - "Bathroom Fan"
            - "Heater"
            - "Humidifier"
            - "Other Device"
          mode: dropdown
    sonoff_model:
      name: ğŸ· Sonoff Model
      description: "Select your Sonoff device. This will adjust settings automatically."
      selector:
        select:
          options:
            - "Sonoff MiniR4M"
            - "Sonoff MiniR4"
            - "Sonoff ZBMINIR2"
            - "Sonoff BasicR3"
            - "Sonoff TX Series"
            - "Sonoff S26"
            - "Other"
          mode: dropdown
      default: "Sonoff MiniR4M"
    switch_type:
      name: ğŸš Switch Type
      description: "Select your switch type."
      selector:
        select:
          options:
            - "Rocker"
            - "Push Button"
          mode: dropdown
    controlled_device:
      name: ğŸ› Device to Control
      description: "Select the device you want to control."
      default: {}
      selector:
        target:
          entity:
            domain: [switch, fan, climate, light]
    enable_relay_detach:
      name: ğŸ”„ Detach Relay
      description: "Detach relay for smart lamps so the switch acts as a trigger without cutting power."
      default: false
      selector:
        boolean:
    enable_adaptive_lighting:
      name: ğŸŒ Adaptive Lighting Mode
      description: "Enable automatic brightness and color temperature adjustments."
      default: false
      selector:
        boolean:
    enable_energy_monitoring:
      name: âš¡ Energy Monitoring
      description: "Enable notifications if power usage is too high."
      default: false
      selector:
        boolean:
    enable_usage_tracking:
      name: ğŸ“Š Usage Tracking
      description: "Enable logging of switch toggles for analytics."
      default: false
      selector:
        boolean:
    enable_safety_lock:
      name: ğŸ”’ Disable Switch Input
      description: "Disable the physical switch input if you donâ€™t need manual control."
      default: false
      selector:
        boolean:
    auto_off_timer:
      name: â³ Auto-Off Timer (Optional)
      description: "Set a timeout to automatically turn off the controlled device."
      default: 0
      selector:
        number:
          min: 0
          max: 3600
          unit_of_measurement: seconds
    humidity_sensor:
      name: ğŸŒ« Humidity Sensor (For Bathroom Fan)
      description: "Select a humidity sensor to automate the fan."
      default: {}
      selector:
        entity:
          domain: sensor
    humidity_threshold:
      name: ğŸ“ˆ Humidity Threshold
      description: "Set the humidity level to activate the fan."
      default: 70
      selector:
        number:
          min: 40
          max: 100
          unit_of_measurement: "%"
    humidity_off_threshold:
      name: ğŸ“‰ Auto Off Humidity Threshold
      description: "Set the humidity level at which the fan should turn off."
      default: 50
      selector:
        number:
          min: 30
          max: 70
          unit_of_measurement: "%"
    fan_runtime:
      name: â³ Fan Runtime
      description: "Set how long the fan should run after activation."
      default: 15
      selector:
        number:
          min: 1
          max: 60
          unit_of_measurement: minutes
    shower_detection:
      name: ğŸš¿ Shower Detection
      description: "Enable automatic fan activation when a rapid humidity increase is detected."
      default: false
      selector:
        boolean:
  
mode: restart
max_exceeded: silent
